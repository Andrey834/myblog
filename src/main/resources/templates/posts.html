<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Posts</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7"
          crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="posts-body">
<header class="header">
    <form class="header-form-search" id="search-form" method="GET" role="search"
          th:action="@{/posts(size=${paging.size},page=1)}">
        <input class="form-control"
               name="search"
               type="search"
               placeholder="Tag search..."
               aria-label="Search"
               th:value="${paging.search}"
               autofocus
        >
        <button class="btn btn-outline-success button" type="submit">Search</button>
        <a class="btn btn-outline-primary button" th:href="@{/posts/add}">Add Post</a>
    </form>
</header>
<section class="section-main">
    <div id="post" class="card-div card" th:each="post : ${posts}">
        <div class="card-div-image">
            <img th:src="'images/' + ${post.image}"
                 onerror="this.src='/myblog/img/promo.jpg'"
                 class="rounded-start card-img"
                 alt="promo image for post"
                 decoding="async"
                 loading="lazy">
        </div>
        <p class="card-p-date " th:text="${post.created}"></p>
        <h5 class="card-h-title">
            <a th:href="@{/posts/{id}(id=${post.id})}" th:text="${post.title}"></a>
        </h5>
        <div class="card-div-content">
            <p class="card-p-content" th:text="${post.preview}"></p>
        </div>
        <div class="card-div-tag link-ease-in-out">
            <a th:href="@{/posts(search=${tag},size=${paging.size},page=${paging.page})}"
               th:each="tag : ${post.tags}"
               th:text="${'#'+tag}"></a>
        </div>
        <div class="card-div-icon">
            <i class="bi bi-suit-heart"></i>
            <p class="card-div-icon-p" th:text="${post.likes}"></p>
            <i class="bi bi-chat-right-text"></i>
            <p class="card-div-icon-p" th:text="${post.countComments}"></p>
        </div>
    </div>
</section>
<footer class="footer mt-auto flex-row footer">
    <nav class="footer-nav">
        <ul class="pagination pg-blue footer-nav-ul">
            <li class="page-item">
                <select form="search-form"
                        name="size"
                        class="form-select"
                        aria-label="Select sizing"
                        id="size"
                        onchange="this.form.submit()">
                    <option th:each="size : ${paging.pageSizes}"
                            th:value="${size}"
                            th:selected="${paging.size==size}"
                            th:text="${size}">
                    </option>
                </select>
            </li>
            <li class="page-item" th:classappend="${paging.page == 1} ? disabled : ''">
                <button class="page-link"
                        aria-label="Previous"
                        form="search-form"
                        type="submit"
                        th:name="page"
                        value="1">
                    <span aria-hidden="true">&laquo;&laquo;</span>
                    <span class="sr-only">First</span>
                </button>
            </li>
            <li class="page-item" th:classappend="${paging.page <= 1} ? disabled : ''">
                <button class="page-link"
                        aria-label="Previous"
                        form="search-form"
                        type="submit"
                        th:name="page"
                        th:value="${paging.page - 1}">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                </button>
            </li>
            <li class="page-item active"><a class="page-link" th:text="${paging.page}"></a></li>
            <li class="page-item" th:classappend="${paging.pageCount <= paging.page} ? disabled : ''">
                <button class="page-link"
                        aria-label="Next"
                        form="search-form"
                        type="submit"
                        th:name="page"
                        th:value="${paging.page + 1}">
                    <span class="sr-only">Next</span>
                    <span aria-hidden="true">&raquo;</span>
                </button>
            </li>
            <li class="page-item" th:classappend="${paging.pageCount <= paging.page} ? disabled : ''">
                <button class="page-link"
                        aria-label="Next"
                        form="search-form"
                        type="submit"
                        th:name="page"
                        th:value="${paging.pageCount}">
                    <span class="sr-only">Last</span>
                    <span aria-hidden="true">&raquo;&raquo;</span>
                </button>
            </li>
        </ul>
    </nav>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
        crossorigin="anonymous"></script>
</body>
</html>
